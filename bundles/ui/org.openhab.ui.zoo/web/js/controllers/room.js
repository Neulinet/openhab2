// Generated by CoffeeScript 1.9.2
'use strict';
angular.module('ZooLib.controllers.room', []).controller('RoomController', function(itemRepository, $log, $scope, $stateParams, $filter, $state) {
  console.log('RoomController state params: ', $stateParams);
  this.rooms = {};
  this.itemsActive = {};
  this.refreshItems = function(force) {
    return itemRepository.getRooms(force).then((function(_this) {
      return function(rooms) {
        $log.debug("loaded rooms", rooms);
        return _this.rooms = $filter('orderBy')(rooms, 'label');
      };
    })(this));
  };
  this.refreshItems().then((function(_this) {
    return function() {
      var firstRoom;
      if (!$stateParams.room && (_this.rooms != null)) {
        firstRoom = Object.keys(_this.rooms).sort()[0];
        $log.debug("Initial redirect to room " + firstRoom);
        return $state.go("rooms.room", {
          active: true,
          room: firstRoom
        });
      }
    };
  })(this));
});
